axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
xlab(expression(paste(" Average SOD (", mu, "mol ", O[2], " ", m^2, " ", h^-1, ")"))) +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
str(annual.data)
View(annual.data)
annual.data <- set.factors.basic(annual.data)
annual.data %>%
ggplot(aes(SOD, N2Flux, colour = Season)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
xlab(expression(paste(" Average SOD (", mu, "mol ", O[2], " ", m^2, " ", h^-1, ")"))) +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
annual.data %>%
ggplot(aes(SOD, N2Flux, colour = Season)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
xlab(expression(paste(" Average SOD (", mu, "mol ", O[2], " ", m^2, " ", h^-1, ")"))) +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20)) +
scale_colour_manual(values = c("darkgoldenrod1", "darkred", "darkblue", "darkgreen"),
labels = c("  Summer",
"  Fall",
"  Winter",
"  Spring"))
annual.data %>%
ggplot(aes(SOD, N2Flux, colour = Season)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
xlab(expression(paste(" Average SOD (", mu, "mol ", O[2], " ", m^2, " ", h^-1, ")"))) +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20)) +
scale_colour_manual(values = c("darkgoldenrod1", "darkred", "darkblue", "darkgreen"),
labels = c("  Summer",
"  Fall",
"  Winter",
"  Spring"))
tiff("Annual N2 regression by SOD, divided by Habitat", width = 300, height = 200, units = "mm", res = 300, compression = "lzw")
annual.data %>%
ggplot(aes(SOD, N2Flux, colour = Season)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
xlab(expression(paste(" Average SOD (", mu, "mol ", O[2], " ", m^2, " ", h^-1, ")"))) +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20)) +
scale_colour_manual(values = c("darkgoldenrod1", "darkred", "darkblue", "darkgreen"),
labels = c("  Summer",
"  Fall",
"  Winter",
"  Spring"))
dev.off()
tiff("Annual N2 regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
tiff("Annual N2 regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
tiff("Annual N2 regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
annual.data %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
tiff("Summer N2 regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
annual.data %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
tiff("Fall N2 regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, N2Flux)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol ", N[2], " ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
annual.data.sand %>%
ggplot(aes(Age, N2Flux, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
scale_colour_manual(values = c("darkorchid4", "olivedrab", "darkgoldenrod"),
labels = c("  oyster",
"  marsh",
"  sandflat")) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
annual.data.sand <- add.sandflat(annual.data)
annual.data.sand$Habitat <- factor(annual.data.sand$Habitat, levels = c("oyster", "marsh", "sandflat"))
annual.data.sand <- set.factors.habitat(annual.data.sand)
annual.data.sand %>%
ggplot(aes(Age, N2Flux, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
scale_colour_manual(values = c("darkorchid4", "olivedrab", "darkgoldenrod"),
labels = c("  oyster",
"  marsh",
"  sandflat")) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
tiff("Annual N2 regression by Habitat", width = 400, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data.sand %>%
ggplot(aes(Age, N2Flux, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 28),
axis.title.y = element_text(margin = margin(r = 15), size = 28),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
scale_colour_manual(values = c("darkorchid4", "olivedrab", "darkgoldenrod"),
labels = c("  oyster",
"  marsh",
"  sandflat")) +
xlab("Restored age (years)") +
ylab(expression(paste("Average ", N[2], " flux (", mu, "mol N ", m^2, " ", h^-1, ")"))) +
coord_cartesian(ylim = c(-10, 120)) +
scale_y_continuous(breaks = seq(-20, 120, 20))
dev.off()
tiff("Annual SOM regression", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data %>%
ggplot(aes(Age, PercentOM)) +
geom_hline(yintercept = 0, size = 0.2, colour = "grey23") +
geom_vline(xintercept = 0, size = 0.2, colour = "grey23") +
geom_point(size = 4) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black")) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
xlab("Restored age (years)") +
ylab("SOM (%)") +
coord_cartesian(ylim = c(0, 10)) +
scale_y_continuous(breaks = seq(0, 10, 2))
dev.off()
annual.data.sand %>%
ggplot(aes(Age, PercentOM, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20))
annual.data.sand %>%
ggplot(aes(Age, PercentOM, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
scale_colour_manual(values = c("darkorchid4", "olivedrab", "darkgoldenrod"),
labels = c("  oyster",
"  marsh",
"  sandflat")) +
xlab("Restored age (years)") +
ylab("SOM (%)") +
coord_cartesian(ylim = c(0, 10)) +
scale_y_continuous(breaks = seq(0, 10, 2))
#Annual SOM regression with age, with a separate line for each habitat
tiff("Annual SOM regression by Habitat", width = 500, height = 160, units = "mm", res = 300, compression = "lzw")
annual.data.sand %>%
ggplot(aes(Age, PercentOM, colour = Habitat)) +
geom_point(size = 4) +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 2) +
theme(panel.background = element_rect(fill = "white", colour = NA),
axis.title.x = element_text(margin = margin(t = 15), size = 26),
axis.title.y = element_text(margin = margin(r = 15), size = 26),
axis.line.x = element_line(colour = "black", size = 0.8),
axis.line.y = element_line(colour = "black", size = 0.8),
panel.grid.major = element_line(colour = "grey70", size = 0.25),
axis.text.x = element_text(size = 20, colour = "black"),
axis.text.y = element_text(size = 20, colour = "black"),
legend.title = element_text(size = 23, face = "bold"),
legend.text = element_text(size = 20)) +
scale_colour_manual(values = c("darkorchid4", "olivedrab", "darkgoldenrod"),
labels = c("  oyster",
"  marsh",
"  sandflat")) +
xlab("Restored age (years)") +
ylab("SOM (%)") +
coord_cartesian(ylim = c(0, 10)) +
scale_y_continuous(breaks = seq(0, 10, 2))
dev.off()
setwd("E:/R Markdown")
library("plyr")
library("dplyr")
library("ggplot2")
library("ggpmisc")
library("lmtest")
library("car")
library("MASS")
source("functions.R")
all.N2 <- read.csv("N2-flux\\clean\\N2-flux-by-core_with-summer15.csv", header = T, stringsAsFactors = F)
DNE <- read.csv("DNE\\clean\\DNE-clean_no-summer15_all-sites.csv", header = T, stringsAsFactors = F)
inund <- read.csv("Inundation\\clean\\inundation-clean_all-sites_all-seasons.csv", header = T)
inund$Age <- as.numeric(inund$Age)
SOM <- read.csv("LOI\\clean\\LOI-by-type_all-seasons_all-sites.csv", header = T)
SOD <- read.csv("SOD\\clean\\SOD-by-type_all-seasons_all-sites.csv", header = T)
O2conc <- read.csv("O2-conc\\clean\\O2-conc-by-type_all-seasons_all-sites.csv", header = T)
nutflux <- read.csv("nutrient-flux\\clean\\nutrient-flux-by-type_all-seasons_all-sites.csv", header = T)
DNF <- read.csv("N2-flux\\clean\\N2-flux-by-type_all-seasons_all-sites.csv", header = T)
#Sequential merges to combine all relevant data frames into a master data frame
#Includes all cores and seasons (including Summer 2015) initially- easier to double-check
#sort = F maintains original ordering scheme
m1 <- merge(inund, SOM, by = c("Site", "Season", "CoreName"), all.x = T, sort = F)
m2 <- merge(m1, SOD, by = c("Site", "Season", "CoreName"), all.x = T, sort = F)
m3 <- merge(m2, O2conc, by = c("Site", "Season", "CoreName"), all.x = T, sort = F)
m4 <- merge(m3, nutflux, by = c("Site", "Season", "CoreName"), all.x = T, sort = F)
m5 <- merge(m4, DNF, by = c("Site", "Season", "CoreName"), all.x = T, sort = F)
#Ensuring that preferred order is preserved
#This will turn Summer 2015 values to NA for easy elimination
m5$Season <- factor(m5$Season, levels = c("Summer", "Fall", "Winter", "Spring"))
m5$Site <- factor(m5$Site, levels = c("IMS", "Carrot", "NOAA", "Army"))
m5$CoreName <- factor(m5$CoreName, levels = c("LO", "HO", "LM", "MM", "HM", "Ref"))
m5$Habitat <- factor(m5$Habitat, levels = c("oyster", "marsh", "Ref"))
#Should only get rid of Summer 2015 rows
master <- na.omit(m5)
#Reorder the columns
master <- master[c("Season", "Site", "Age", "CoreName", "Habitat",  "avg_N2Flux", "Perc_Inun", "avg_PercentOM", "avg_SOD", "avg_O2conc", "avg_flux_NOx", "avg_flux_NH3")]
#Rename the columns so they're less bulky
master <- plyr::rename(master, c("avg_N2Flux" = "N2flux", "Perc_Inun" = "Inund", "avg_PercentOM" = "SOM", "avg_SOD" = "SOD", "avg_O2conc" = "O2conc", "avg_flux_NOx" = "NOxflux", "avg_flux_NH3" = "NH3flux"))
View(inund)
View(SOM)
View(SOD)
head(inund)
head(SOM)
View(m5)
View(master)
master <- season.numbers(master)
master <- habitat.numbers(master)
master <- master[c("Season", "SeasonNumber", "Site", "Age", "CoreName", "Habitat", "HabitatNumber",  "N2flux", "Inund", "SOM", "SOD", "O2conc", "NOxflux", "NH3flux")]
summer <- master[master$Season == "Summer", ]
fall <- master[master$Season == "Fall", ]
winter <- master[master$Season == "Winter", ]
spring <- master[master$Season == "Spring", ]
IMS <- master[master$Site == "IMS", ]
Carrot <- master[master$Site == "Carrot", ]
NOAA <- master[master$Site == "NOAA", ]
Army <- master[master$Site == "Army", ]
View(Army)
fit.all <- rpart(N2flux ~ SeasonNumber + HabitatNumber + Age + Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = master)
library("rpart")
library("rpart.plot")
fit.all <- rpart(N2flux ~ SeasonNumber + HabitatNumber + Age + Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = master)
summary(fit.all)
plot(fit.all, uniform = T)
text(fit.all, use.n = T, all = T, cex = 0.8)
pruned.all <- prune(fit.all, cp = 0.04)
plot(pruned.all, uniform = T)
text(pruned.all, use.n = T, all = T, cex = 0.8)
pruned.all <- prune(fit.all, cp = 0.01)
plot(pruned.all, uniform = T)
text(pruned.all, use.n = T, all = T, cex = 0.8)
summary(fit.all, cp = 0.002)
pruned.all <- prune(fit.all, cp = 0.04)
plot(pruned.all, uniform = T)
text(pruned.all, use.n = T, all = T, cex = 0.8)
fit.BCG <- rpart(N2flux ~ Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = master)
summary(fit.BCG)
plotcp(fit.BCG)
plot(fit.BCG, uniform = T)
text(fit.BCG, use.n = T, all = T, cex = 0.8)
pruned.BCG <- prune(fit.BCG, cp = 0.055)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
summary(pruned.BCG)
prp(pruned.BCG)
pruned.BCG <- prune(fit.BCG, cp = 0.04)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
pruned.BCG <- prune(fit.BCG, cp = 0.055)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
plot(pruned.all, uniform = T)
text(pruned.all, use.n = T, all = T, cex = 0.8)
fit.BCG <- rpart(N2flux ~ Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = master)
summary(fit.BCG)
fit.BCG <- rpart(N2flux ~ Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = master)
summary(fit.BCG)
plotcp(fit.BCG)
plot(fit.BCG, uniform = T)
text(fit.BCG, use.n = T, all = T, cex = 0.8)
pruned.BCG <- prune(fit.BCG, cp = 0.055)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
pruned.BCG <- prune(fit.BCG, cp = 0.04)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
pruned.BCG <- prune(fit.BCG, cp = 0.04)
plot(pruned.BCG, uniform = T)
text(pruned.BCG, use.n = T, all = T, cex = 0.9)
summary(pruned.BCG)
rsq.rpart(pruned.BCG)
summer.tree <- rpart(N2flux ~ Age + Inund + SOM + SOD + O2conc + NOxflux + NH3flux, method = "anova", data = summer)
summer.tree$cptable
summer.prune <- prune(summer.tree, cp = summer.tree$cptable[which.min(summer.tree$cptable[ ,"xerror"]), "CP"])
summer.prune <- prune(summer.tree, cp = summer.tree$cptable[which.min(summer.tree$cptable[ ,"xerror"]), "CP"])
plot(summer.prune, uniform = T, main = "Pruned Regression Tree for Summer DNF Rates", cex = 0.5)
text(summer.prune, use.n = T, all = T, cex = 0.5)
