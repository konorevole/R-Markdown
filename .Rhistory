= "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), se = F, size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), se = F, size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.sed %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.sed %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.sed %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.sed %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), se = F, size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(all.avgs)
View(annual.data)
str(annual.data)
summary(lm(annual.data$BulkDensity~annual.data$Age))
summary(lm(annual.data$SOD~annual.data$Age))
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
summary(lm(annual.data$BulkDensity~cbind(annual.data$Age,annual.data$Age^2)))
summary(lm(annual.data$SOD~cbind(annual.data$Age,annual.data$Age^2)))
summary(lm(annual.data$O2conc~cbind(annual.data$Age,annual.data$Age^2)))
melted.annual %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(melted.annual)
melted.annual2 <- melted.annual[!melted.annual$variable == "O2conc", ]
melted.annual2 <- melted.annual2[!melted.annual2$variable == "NOxFlux", ]
melted.annual2 <- melted.annual2[!melted.annual2$variable == "NH3Flux", ]
View(melted.annual2)
melted.annual2 %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual2 %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual2 %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual2 %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual2 %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual2 %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ x, se = F, size = 1) +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = y ~ x),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(sed.data)
sed.data <- read.csv("PRIMER\\raw\\sed-data_spring15_all-sites.csv", header = T, stringsAsFactors = F)
View(sed.data)
sed.data$Site <- factor(sed.data$Site, levels = c("IMS", "Carrot", "NOAA", "Army"))
sed.data$CoreName <- factor(sed.data$CoreName, levels = c("LO", "HO", "LM", "MM", "HM", "Ref"))
sed.data$Habitat <- factor(sed.data$Habitat, levels = c("oyster", "marsh", "Ref"))
sed.data <- add.age(sed.data)
sed.data$Age <- as.numeric(sed.data$Age)
str(sed.data)
melted.sed2 <- melt(sed.data, measure.vars = c("PercentC", "PercentN", "CtoN", "BulkDensity", "SpringN2", "AnnualN2"))
View(melted.sed)
View(melted.sed2)
melted.sed2 <- melted.sed2[melted.sed2$variable %in% c("BulkDensity", "AnnualN2"), ]
View(melted.sed2)
melted.sed2 %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.sed2 %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.sed2 %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(melted.sed)
?left_join
?cbind
melted.sed2 <- melted.sed$Season
View(melted.sed)
melted.sed2 <- melted.sed$Season <- c("Spring")
melted.sed$Season <- c("Spring")
View(melted.sed)
View(melted.sed)
str(melted.sed)
melted.sed2 <- melted.sed[c("Season", "Site", "CoreName", "Habitat", "Age", "variable", "value"), ]
View(melted.sed2)
melted.sed2 <- melted.sed[, c("Season", "Site", "CoreName", "Habitat", "Age", "variable", "value")]
View(melted.sed2)
?left_join
bulk.density <- melted.sed2[melted.sed2$variable == "BulkDensity", ]
View(bulk.density)
sed.join <- full_join(melted.annual2, bulk.density)
View(sed.join)
sed.join <- sed.join[c("SOD", "PercentOM", "BulkDensity", "N2Flux"), ]
View(sed.join)
sed.join <- full_join(melted.annual2, bulk.density)
sed.join$variable <- sed.join$variable(c("SOD", "PercentOM", "BulkDensity", "N2Flux"))
sed.join %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
sed.join$variable <- factor(sed.join$variable, levels = c("SOD", "PercentOM", "BulkDensity", "N2Flux"))
sed.join %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
sed.join %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
revalue(sed.join, c("ref" = "Ref"))
str(sed.join)
revalue(sed.join$Habitat, c("ref" = "Ref"))
sed.join %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
sed.join$Habitat <- revalue(sed.join$Habitat, c("ref" = "Ref"))
sed.join %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
sed.join %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T, label.y.npc = "top") +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(sed.join)
str(sed.join)
sed.join$Habitat <- factor(sed.join$Habitat, c("oyster", "marsh", "Ref"))
sed.join %>%
ggplot(aes(Age, value, colour = Habitat)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = quad.formula, se = F, size = 1) +
stat_poly_eq(formula = quad.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
method.args = list(formula = quad.formula),
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
