View(melted.annual)
View(melted.annual)
p4 <- ggplot(melted.annual, aes(Age, value))
p4 + geom_line(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y") +
opts(legend.position = "none")
p4 <- ggplot(melted.annual, aes(Age, value))
p4 + geom_line(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
p4 + geom_line(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y") +
legend(plot = F)
?legend
p4 + geom_line(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
p4 + geom_scatter(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
p4 <- ggplot(melted.annual, aes(Age, value))
p4 + geom_point(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
annual.data %>%
filter(Season = "Summer") %>%
ggplot(melted.annual, aes(Age, value)) +
geom_point(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
annual.data %>%
filter(Season == "Summer") %>%
ggplot(melted.annual, aes(Age, value)) +
geom_point(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = variable)) +
facet_grid(variable ~ ., scales = "free_y") +
theme(legend.position = "none")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
theme(legend.position = "none")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(group = 3, method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(group = Habitat, method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(group = Habitat), method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual <- na.omit(melted.annual)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(group = Habitat), method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y"
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
stat_smooth(aes(group = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(group = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Site)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Fall") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(group = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual2 <- melted.annual[!melted.annual$variable = "PercentInundation", ]
melted.annual2 <- melted.annual[!melted.annual$variable == "PercentInundation", ]
View(melted.annual2)
melted.annual <- melted.annual[!melted.annual$variable == "PercentInundation", ]
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Winter") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ ln(x)), size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ ln(x), size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ log(x, 10), size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ x, size = 1)
melted.annual %>%
filter(Season == "Spring") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ x + I(x^2), size = 1)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
View(annual.data)
View(all.avgs)
all.avgs2 <- na.omit(all.avgs)
View(all.avgs2)
View(all.avgs.nona)
str(all.avgs.nona)
melted.avgs <- melt(all.avgs.nona, measure.vars = c("PercentC", "PercentN", "CtoN", "PercentOM", "BulkDensity", "N2Flux"))
View(melted.avgs)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
View(all.avgs.nona)
all.avgs.nona <- add.age(all.avgs.nona)
all.avgs.nona$Age <- as.numeric(all.avgs.nona$Age)
melted.avgs <- melt(all.avgs.nona, measure.vars = c("PercentC", "PercentN", "CtoN", "PercentOM", "BulkDensity", "N2Flux"))
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
#I think this is the annual version of the above
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y")
View(all.avgs.nona)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
View(all.avgs.nona)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,4), size = 1)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
geom_text(data = melted.avgs, label = paste("R^2: ", r2, sep = ""), parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
geom_text(data = melted.avgs, label = paste("R^2: ", ..r2.., sep = ""), parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
geom_text(label = lm_eqn(melted.avgs), parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_smooth_func(geom = "text", method = "lm", parse = T)
library("ggpmisc")
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_smooth_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., ..p.value.., sep = "~~~")),
parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., ..p.., sep = "~~~")),
parse = T)
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
filter(Season == "Summer") %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ x + I(x^2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(group = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(group = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(group = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T)
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point(aes(colour = Habitat)) +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(aes(colour = Habitat), method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(colour = Habitat, label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(colour = Habitat, label = paste("P-value =", signif(..p.value.., digits = 4), sep
= "")),
label.x.npc = "right")
melted.avgs %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
melted.annual %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
spring <- read.csv("PRIMER\\raw\\all-data_spring15_all-sites.csv", header = T, stringsAsFactors = F)
View(spring)
spring <- add.age(spring)
View(spring)
spring$Age <- as.numeric(Spring$AGe)
spring$Age <- as.numeric(Spring$Age)
spring$Age <- as.numeric(spring$Age)
str(spring)
spring <- set.factors.basic(spring)
View(set.factors.basic)
spring$Site <- factor(spring$Site, levels = c("IMS", "Carrot", "NOAA", "Army"))
spring$Habitat <- factor(spring$Habitat, levels = c("oyster", "marsh", "ref"))
str(spring)
melted.spring <- melt(spring, measure.vars = c("Inundation", "PercentC", "PercentN", "CtoN", "BulkDensity", "SpringPercentOM", "SpringSOD", "SpringO2", "SpringN2"))
View(melted.spring)
melted.spring %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
View(melted.annual)
melted.spring <- na.omit(melted.spring)
melted.spring %>%
ggplot(aes(Age, value)) +
geom_point() +
facet_grid(variable ~ ., scales = "free_y") +
geom_smooth(method = "lm", formula = y ~ poly(x,2), size = 1) +
stat_poly_eq(formula = y ~ poly(x,2),
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = T) +
stat_fit_glance(method = "lm",
geom = "text",
aes(label = paste("P-value =", signif(..p.value.., digits = 4), sep = "")),
label.x.npc = "right")
pairs(spring[ , 4:12], upper.panel = panel.cor)
spring.nona <- na.omit(spring)
pairs(spring.nona[ , 4:12], upper.panel = panel.cor)
